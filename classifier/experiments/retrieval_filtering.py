# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/experiments/10_10k_retrieval_filtering.ipynb.

# %% auto 0
__all__ = ['EXPERIMENT_PREFIX', 'EXPERIMENT_WRITE_PREFIX']

# %% ../../nbs/experiments/10_10k_retrieval_filtering.ipynb 2
from typing import Dict, List
from pathlib import Path
import numpy as np
import pandas as pd
from tqdm import tqdm
from sklearn import metrics, model_selection

from langchain.prompts import PromptTemplate
from langchain.schema.runnable import RunnableSequence
from langchain.llms import VertexAI
from langchain.vectorstores import Chroma
from langchain.document_loaders import DataFrameLoader

from ..schema import get_embedder, get_model, quota_handler, WRITE_PREFIX, PROJECT_BUCKET
from ..load import Email, get_batches, get_idx, get_emails_from_frame, \
    get_possible_labels, get_raw_emails, email_small_enough, write_idx
from ..chroma import get_or_make_chroma
from ..predict import make_prediction_prompt, get_predictions, write_predictions
from classifier.experiments.split_processing import \
    format_email_for_train_summary, \
    format_email_for_test_summary, \
    make_description_from_row, batch_predict, \
    TRAIN_PROMPT, TEST_PROMPT

EXPERIMENT_PREFIX = "retrieval_filtering"
EXPERIMENT_WRITE_PREFIX = WRITE_PREFIX + "/" + EXPERIMENT_PREFIX
